#pragma once

#include <windows.h>
#include <lstate.h>
#include <lualib.h>
#include <string>

namespace task_scheduler
{
    bool setup_exploit();
    void request_execution(const std::string& script);
    void set_proto_capabilities(Proto* proto, uintptr_t* capabilities);
    void set_thread_capabilities(lua_State* L, int level, uintptr_t capabilities);

    uintptr_t get_data_model();
    uintptr_t get_script_context(uintptr_t data_model);
    lua_State* get_lua_state_for_instance(uintptr_t script_context);
}
